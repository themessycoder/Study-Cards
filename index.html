<!DOCTYPE html><html lang='en'><head>
  <meta charset='utf-8'/>
  <meta name='viewport' content='width=device-width, initial-scale=1, viewport-fit=cover'/>
  <title>Flashcards • CSV (PWA)</title>
  <link rel='manifest' href='manifest.json'>
  <meta name='apple-mobile-web-app-capable' content='yes'>
  <meta name='apple-mobile-web-app-status-bar-style' content='black-translucent'>
  <meta name='theme-color' content='#0f1218'>
  <link rel='apple-touch-icon' href='icons/icon-192.png'>
  <style>
:root{--bg:#0f1218;--panel:#171b22;--text:#e8ecf1;--muted:#9aa6b2;--accent:#7c9cff;--accent-2:#52dfa3;--danger:#ff6b6b;--shadow:0 10px 30px rgba(0,0,0,.35);--radius:14px}
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;font-family:-apple-system,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:radial-gradient(1200px 600px at 20% -10%, rgba(124,156,255,.15), transparent 60%),radial-gradient(1200px 600px at 120% 110%, rgba(82,223,163,.12), transparent 60%),var(--bg);color:var(--text);min-height:100vh;display:grid;grid-template-rows:auto 1fr auto;overflow-x:hidden;padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right)}
header{padding:16px;padding-top:calc(10px + env(safe-area-inset-top));border-bottom:1px solid rgba(255,255,255,.06);position:sticky;top:0;z-index:5;background:rgba(15,18,24,.7);backdrop-filter:blur(6px)}
h1{font-size:clamp(16px,3.5vw,22px);margin:0 0 6px}.sub{color:var(--muted);font-size:clamp(12px,2.6vw,14px)}
.toolbar{display:grid;gap:10px;margin-top:10px;grid-template-columns:1fr}.toolbar .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
@media (min-width:560px){.toolbar{grid-template-columns:1fr 1fr}}
select,button{background:var(--panel);color:var(--text);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px 14px;font-size:clamp(14px,2.8vw,16px);box-shadow:var(--shadow);-webkit-tap-highlight-color:transparent}
button{cursor:pointer}.primary{border-color:rgba(124,156,255,.4)}.accent{border-color:rgba(82,223,163,.4)}.danger{border-color:rgba(255,107,107,.35)}.ghost{background:transparent;border-color:rgba(255,255,255,.12)}
main{display:grid;place-items:center;padding:12px}.stage{width:min(960px,100vw);display:grid;gap:12px}
.meta{display:flex;gap:8px;flex-wrap:wrap;color:var(--muted);font-size:clamp(12px,2.6vw,13px)}.badge{padding:6px 10px;background:rgba(124,156,255,.12);border:1px solid rgba(124,156,255,.25);border-radius:999px}
.card{perspective:1200px;position:relative;height:clamp(260px, min(70vh, 90vw), 560px)}
.card-inner{position:absolute;inset:0;border-radius:var(--radius);background:linear-gradient(180deg,rgba(23,27,34,1),rgba(23,27,34,.9));border:1px solid rgba(255,255,255,.08);box-shadow:var(--shadow);transform-style:preserve-3d;transition:transform .5s cubic-bezier(.2,.8,.2,1);display:grid;place-items:center;padding:clamp(14px,3vw,22px);text-align:left}
.card-inner.flipped{transform:rotateY(180deg)}
.face{position:absolute;inset:0;display:grid;place-items:center;padding:clamp(14px,3vw,22px);backface-visibility:hidden;overflow:auto;-webkit-overflow-scrolling:touch}
.face h2{font-size:clamp(18px,5vw,26px);line-height:1.3;margin:0;font-weight:650}
.face p{line-height:1.55;font-size:clamp(15px,4.4vw,18px);margin:0;white-space:pre-wrap}
.back{transform:rotateY(180deg)}
.controls{display:grid;gap:10px;grid-template-columns:repeat(2,1fr)}
@media (min-width:640px){.controls{grid-template-columns:repeat(4,1fr)}}
footer{color:var(--muted);padding:14px;padding-bottom:calc(12px + env(safe-area-inset-bottom));text-align:center;border-top:1px solid rgba(255,255,255,.06)}
.empty{color:var(--muted);border:1px dashed rgba(255,255,255,.2);border-radius:var(--radius);padding:14px;text-align:center}
</style>
</head><body>
  <header>
    <h1>Flashcards • CSV (PWA)</h1>
    <div class="sub">Optimized for iPhone. Install to Home Screen. Works offline.</div>
    <div class="toolbar">
      <div class="row">
        <select id="chapterFilter" title="Filter by chapter"><option value="__ALL__">All chapters</option></select>
        <button id="applyFilter" class="primary">Apply Filter</button>
        <button id="reshuffle" class="ghost">Re‑shuffle</button>
      </div>
      <div class="row">
        <button id="clearViewed" class="accent">Clear Viewed</button>
        <button id="resetSession" class="danger">Reset Session</button>
      </div>
    </div>
  </header>
  <main>
    <div class="stage">
      <div class="meta">
        <span id="metaPool" class="badge">Pool: 0</span>
        <span id="metaViewed" class="badge">Viewed: 0</span>
        <span id="metaChapter" class="badge">Chapter: All</span>
        <span id="metaProgress" class="badge">Progress: 0 / 0</span>
        <span class="badge">Tap card to flip</span>
      </div>
      <div class="card" id="card">
        <div class="card-inner" id="cardInner">
          <div class="face front"><h2 id="frontText"></h2></div>
          <div class="face back"><p id="backText"></p></div>
        </div>
      </div>
      <div id="emptyState" class="empty" hidden>
        <p>No cards left in the pool for this filter. Use <strong>Clear Viewed</strong> or change the filter.</p>
      </div>
      <div class="controls">
        <button id="prevBtn">← Previous</button>
        <button id="flipBtn" class="primary">Flip</button>
        <button id="nextBtn" class="primary">Next →</button>
        <button id="skipBtn" class="ghost">Skip</button>
      </div>
    </div>
  </main>
  <footer>Flashcards PWA • Offline • iPhone-friendly layout</footer>
  
<script defer src="./flashcards-app.js?v=6"></script>
<script>
  if ('serviceWorker' in navigator) navigator.serviceWorker.register('./service-worker-v2.js?v=6');
  window.addEventListener('DOMContentLoaded', () => {
    window.__FlashcardsApp__.initFromCSV('./flashcards.csv?v=' + Date.now());
  });
</script>
  
</body></html>
